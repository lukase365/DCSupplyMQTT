// SPDX-License-Identifier: Apache-2.0
// Copyright Pionix GmbH and Contributors to EVerest
#ifndef DCSUPPLYMQTT_MAIN_DC_MQTT_BROKER_HPP
#define DCSUPPLYMQTT_MAIN_DC_MQTT_BROKER_HPP

// /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//  WARNING!!! THIS MODULE IS ONLY FOR EXPERIMENTAL USE AND NOT FOR A REAL CHARGING STATION !!!! WARNING ///////////////
// /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//  WARNING!!! THIS MODULE IS ONLY FOR EXPERIMENTAL USE AND NOT FOR A REAL CHARGING STATION !!!! WARNING ///////////////
// /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//  WARNING!!! THIS MODULE IS ONLY FOR EXPERIMENTAL USE AND NOT FOR A REAL CHARGING STATION !!!! WARNING ///////////////
// /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//  WARNING!!! THIS MODULE IS ONLY FOR EXPERIMENTAL USE AND NOT FOR A REAL CHARGING STATION !!!! WARNING ///////////////
// /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

#include "ld-ev.hpp"
#include <thread>

// headers for provided interface implementations
#include <generated/interfaces/power_supply_DC/Implementation.hpp>

class MqttBroker {
public:
    MqttBroker();

    const std::unique_ptr<power_supply_DCImplBase> p_main;

    void read_voltage(float& voltage);
    void read_current(float& current);
    void write_voltage_current(float voltage, float current);


private:
    //std::thread loop_thread;
    float voltage_ex;
};

extern float voltage_ev_out;
extern float current_ev_out;
extern float voltage_ps_in;
extern float current_ps_in;

#endif // DCSUPPLYMQTT_MAIN_DC_MQTT_BROKER_HPP
